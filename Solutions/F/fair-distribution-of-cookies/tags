Brute force enumeration with combinatorics
