Dynamic programming with auxiliary array
